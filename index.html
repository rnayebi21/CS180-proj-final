<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CS180 - Final Project</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="15a9ad28-a8e1-803a-b200-d5845c6c1619" class="page sans"><header><h1 class="page-title">CS180 - Final Project</h1><p class="page-description"></p></header><div class="page-body"><h1 id="15a9ad28-a8e1-8053-8864-c101f7e7c6de" class="">Part 1: Fit a Neural Field to a 2D Image</h1><p id="15a9ad28-a8e1-80bc-868b-c7000cdeeb1f" class="">In general Neural Radiance Fields (NeRF) are used to represent a 3D space. However I will start off simple with a 2D example to begin with. Given that there isn’t a concept of radiance in  2D, the Neural Radiance Field just becomes a Neural Field ie <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">}</mo><mo>→</mo><mo stretchy="false">{</mo><mi>r</mi><mo separator="true">,</mo><mi>g</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">F: \{u, v\}
      \rightarrow \{r, g, b\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">}</span></span></span></span></span><span>﻿</span></span> in 2D, where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{u, v\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">}</span></span></span></span></span><span>﻿</span></span> is the pixel coordinate. To do this, I will create a Multilayer Perceptron (MLP) network with a Sinusoidal Positional Encoding (PE). The purpose of the PE is to change the dimensions of the input coordinates from being 2 dimensional to <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>L</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">4L + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> dimensions, where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span><span>﻿</span></span> is highest frequency level. This is done by applying a series of sinusoidal functions to the input coordinates. This way the network can learn a more complex function.</p><figure id="15a9ad28-a8e1-80f4-82ba-f3bf7f7cceaa" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="0.9em"><mi>P</mi><mi>E</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mo separator="true">,</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>0</mn></msup><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>0</mn></msup><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>1</mn></msup><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>1</mn></msup><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>L</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>L</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mstyle></mrow><annotation encoding="application/x-tex">\small PE(x) = \{x, sin(2^0\pi x), cos(2^0\pi x),        sin(2^1\pi x), cos(2^1\pi x), ..., sin(2^{L-1}\pi x), cos(2^{L-1}\pi x)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05764em;">PE</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0067em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">{</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5">s</span><span class="mord mathnormal sizing reset-size6 size5">in</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">π</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5">cos</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">π</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5">s</span><span class="mord mathnormal sizing reset-size6 size5">in</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">π</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5">cos</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">π</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sizing reset-size6 size5">...</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5">s</span><span class="mord mathnormal sizing reset-size6 size5">in</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">π</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5">cos</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">π</span><span class="mord mathnormal sizing reset-size6 size5">x</span><span class="mclose sizing reset-size6 size5">)}</span></span></span></span></span></div></figure><p id="15a9ad28-a8e1-80fb-b1e8-f7d720f98e7c" class="">To start off we follow the following architecture on </p><figure id="15a9ad28-a8e1-80ce-8434-e08ba425c928" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image.png"><img style="width:2332px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image.png"/></a></figure><p id="15b9ad28-a8e1-8078-8095-fccf31c99993" class="">I tried testing out various parameters and their impact on the PSNR which a quality metric is defined as <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtext>PSNR</mtext><mo>=</mo><mn>10</mn><mo>⋅</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>10</mn></msub><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mtext>MSE</mtext></mfrac><mo fence="true">)</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \text{PSNR} = 10 \cdot \log_{10}\left(\frac{1}{\text{MSE}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">PSNR</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">MSE</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span><span>﻿</span></span>. This hyper parameter tuning left me with the following</p><div id="15c9ad28-a8e1-8089-b1dc-c07c06e125e1" class="column-list"><div id="15c9ad28-a8e1-8069-a483-e91d5577e732" style="width:33.333333333333336%" class="column"><figure id="15c9ad28-a8e1-8043-a6d5-ec98a560010e" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%201.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%201.png"/></a></figure></div><div id="15c9ad28-a8e1-80d5-8fa8-f6bc87c9ef07" style="width:33.333333333333336%" class="column"><figure id="15c9ad28-a8e1-801f-81dd-e7c319f8f694" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%202.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%202.png"/></a></figure></div><div id="15c9ad28-a8e1-809c-9336-f28428e38955" style="width:33.33333333333333%" class="column"><figure id="15c9ad28-a8e1-80bd-9c66-ed92198bfad5" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%203.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%203.png"/></a></figure></div></div><div id="15c9ad28-a8e1-80af-93f7-c987ad91136f" class="column-list"><div id="15c9ad28-a8e1-800e-b10a-f85cf23286b9" style="width:62.5%" class="column"><p id="15b9ad28-a8e1-8047-b726-cbe5bfc479a8" class="">Thus based on these graphs I decided to train a model using the architecture above and balancing these parameters, with <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">L = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></span><span>﻿</span></span>, hidden dim=128, lr = 0.005. This resulted in the following reconstruction (original image seen on the right)</p></div><div id="15c9ad28-a8e1-8010-b283-e771ef4073c1" style="width:37.5%" class="column"><figure id="15c9ad28-a8e1-80da-8f15-f8e1fff5deb6" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/15677707699_d9d67acf9d_b.jpg"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/15677707699_d9d67acf9d_b.jpg"/></a><figcaption>Original Image</figcaption></figure></div></div><p id="15c9ad28-a8e1-8074-ab28-faeb082622f2" class="">
</p><div id="15c9ad28-a8e1-80aa-bb44-c401f37a0cf1" class="column-list"><div id="15c9ad28-a8e1-8065-b9fa-f340d7a0d24e" style="width:25%" class="column"><figure id="15c9ad28-a8e1-804f-abb5-cb6accf1832c" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%204.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%204.png"/></a></figure></div><div id="15c9ad28-a8e1-80df-9c6e-efdd11c54dbc" style="width:25%" class="column"><figure id="15c9ad28-a8e1-8046-aa76-fe4b6900337e" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%205.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%205.png"/></a></figure></div><div id="15c9ad28-a8e1-80fb-8a74-e7016d16fa83" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80ca-906b-e27b287ad51b" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%206.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%206.png"/></a></figure></div><div id="15c9ad28-a8e1-80c0-b88a-eed26a347940" style="width:25%" class="column"><figure id="15c9ad28-a8e1-803d-bfb1-e15d2e3fad97" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%207.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%207.png"/></a></figure></div></div><div id="15c9ad28-a8e1-802f-b524-ec5a16590234" class="column-list"><div id="15c9ad28-a8e1-80c4-a6fc-f1416f22f871" style="width:25%" class="column"><figure id="15c9ad28-a8e1-8013-9e93-c3041999617e" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%208.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%208.png"/></a></figure></div><div id="15c9ad28-a8e1-80f3-8b6f-e7caa864d645" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80e5-b6dd-ccd3a79f7292" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%209.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%209.png"/></a></figure></div><div id="15c9ad28-a8e1-806e-84f5-fa10f4bd802f" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80d3-8102-f363b8471bc3" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2010.png"><img style="width:205.328125px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2010.png"/></a></figure></div><div id="15c9ad28-a8e1-805a-9e1c-f08a29aa8e6c" style="width:25%" class="column"><figure id="15c9ad28-a8e1-8041-a246-cde22afacc97" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2011.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2011.png"/></a></figure></div></div><figure id="15c9ad28-a8e1-809e-b3e6-d55bc9c31734" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2012.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2012.png"/></a></figure><p id="15c9ad28-a8e1-80b7-8d24-d87e0a2133b6" class="">
</p><p id="15c9ad28-a8e1-80ce-8990-ff90072ea955" class="">This is the result doing the same process with the same parameters (as they also performed well here) on my own image:</p><p id="15c9ad28-a8e1-805a-afb4-e6df08fe26c7" class="">Original</p><div id="15c9ad28-a8e1-80c7-8640-c1210be73348" class="column-list"><div id="15c9ad28-a8e1-8012-8afd-ca79e0a8d422" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80e2-9158-f2c37c6bcd9c" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2013.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2013.png"/></a></figure></div><div id="15c9ad28-a8e1-80a0-87b9-e6908ff8eefb" style="width:25%" class="column"><figure id="15c9ad28-a8e1-8072-967f-c82a852335df" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2014.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2014.png"/></a></figure></div><div id="15c9ad28-a8e1-80d4-8640-e7dbad931322" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80a7-b2b2-dce0cd70b5f7" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2015.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2015.png"/></a></figure></div><div id="15c9ad28-a8e1-80b0-a0fc-d7a933cee23d" style="width:25%" class="column"><figure id="15c9ad28-a8e1-805c-a26b-ecb80213cf43" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2016.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2016.png"/></a></figure></div></div><div id="15c9ad28-a8e1-8086-ac05-d85d6973c19b" class="column-list"><div id="15c9ad28-a8e1-809f-a37b-cfcedc5aef8b" style="width:25%" class="column"><figure id="15c9ad28-a8e1-8016-a919-e7f1c1b8f0a2" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2017.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2017.png"/></a></figure></div><div id="15c9ad28-a8e1-802c-a4b4-d0d3b5058d0b" style="width:25%" class="column"><figure id="15c9ad28-a8e1-8065-901d-c84208b05558" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2018.png"><img style="width:331px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2018.png"/></a></figure></div><div id="15c9ad28-a8e1-8051-a4ec-d8c657533071" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80a1-9cda-d7a0ee7dffe2" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2019.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2019.png"/></a></figure></div><div id="15c9ad28-a8e1-808a-a74c-d68a99c8a2cd" style="width:25%" class="column"><figure id="15c9ad28-a8e1-80c9-ba60-c2dfb76a61e7" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2020.png"><img style="width:515px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2020.png"/></a></figure></div></div><figure id="15c9ad28-a8e1-80c6-8bf4-d94eb9816cec" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2021.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2021.png"/></a></figure><div id="15c9ad28-a8e1-80c2-bf05-c58eb0e3f179" class="column-list"><div id="15c9ad28-a8e1-807d-a4e6-ea6bf0a2dd7b" style="width:50%" class="column"><figure id="15c9ad28-a8e1-8063-8bb0-d370dd0a6772" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/axoltl_2.jpg"><img style="width:432px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/axoltl_2.jpg"/></a><figcaption>Original image</figcaption></figure></div><div id="15c9ad28-a8e1-8032-8cbb-f4ebfb15d960" style="width:50%" class="column"><figure id="15c9ad28-a8e1-8095-a808-ee5ceb979bf4" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/e4ce1d20-72ed-43b7-9566-aa5ac12c5fd4.png"><img style="width:500.82539682539687px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/e4ce1d20-72ed-43b7-9566-aa5ac12c5fd4.png"/></a><figcaption>NeRF</figcaption></figure></div></div><h1 id="15b9ad28-a8e1-806d-9d41-cd00b33976e3" class="">Part 2: Fit a Neural Radiance Field from Multi-view Images</h1><p id="15b9ad28-a8e1-80ae-9bad-c55c07864286" class="">Now that we’ve been able to successfully reconstruct a 2D image, we will move to reconstructing a 3D space through a Neural Radiance Field (NeRF). Here we are using the Lego scene from the original <mark class="highlight-blue"><a href="https://arxiv.org/abs/2003.08934">NERF paper</a></mark><mark class="highlight-default">, but with lower resolution images (200 x 200) and preprocessed cameras. </mark></p><h3 id="15b9ad28-a8e1-80fa-ba04-e486a117d6d3" class="">Part 2.1: Create Rays from Cameras</h3><p id="15b9ad28-a8e1-80ef-a814-c7b3671f1bed" class="">For this part, I generated rays from camera positions into the 3D world. First, I transformed points from the camera to the world using the camera-to-world matrix. Then, I converted pixel coordinates back into 3D camera space with the intrinsic matrix. Finally, I calculated each ray&#x27;s origin (the camera position) and direction (a normalized vector pointing into the world). I checked my work by visualizing the rays, cameras, and sampled points, ensuring everything aligned correctly. Here is the three steps outlined mathematically </p><ol type="1" id="15b9ad28-a8e1-80c3-afc6-d598ac1efd30" class="numbered-list" start="1"><li>Camera-to-World Transformation:<p id="15b9ad28-a8e1-80b5-999b-f504bc2049ca" class="">To transform a point <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="bold">x</mtext><mi>c</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mi>c</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>c</mi></msub><mo separator="true">,</mo><msub><mi>z</mi><mi>c</mi></msub><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mi mathvariant="normal">⊤</mi></msup></mrow><annotation encoding="application/x-tex">\textbf{x}_c = [x_c, y_c, z_c, 1]^\top</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> in the camera space to the world space, I used the camera-to-world (c2w) matrix:</p><figure id="15b9ad28-a8e1-80ba-aab3-de7b07a5d7dd" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>w</mi></msub><mo>=</mo><mi mathvariant="normal">c</mi><mn>2</mn><mi mathvariant="normal">w</mi><mo>⋅</mo><msub><mi mathvariant="bold">x</mi><mi>c</mi></msub><mo separator="true">,</mo><mspace width="1em"/><mtext> where </mtext><mi mathvariant="bold">c</mi><mn>2</mn><mi mathvariant="normal">w</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">t</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn mathvariant="bold">0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x}_w=\mathrm{c} 2 \mathrm{w} \cdot \mathbf{x}_c, \quad \text { where } \mathbf{c} 2 \mathrm{w}=\left[\begin{array}{ll}R &amp; \mathrm{t} \\\mathbf{0} &amp; 1\end{array}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathrm">c</span><span class="mord">2</span><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord"> where </span></span><span class="mord mathbf">c</span><span class="mord">2</span><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">t</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></div></figure><p id="15b9ad28-a8e1-8042-b013-ec896d603d67" class="">I verified this by applying the inverse world-to-camera (w2c) matrix to ensure <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>c</mi></msub><mo>=</mo><mi mathvariant="normal">w</mi><mn>2</mn><mi mathvariant="normal">c</mi><mo>⋅</mo><msub><mi mathvariant="bold">x</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_c=\mathrm{w} 2 \mathrm{c} \cdot \mathbf{x}_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mord">2</span><span class="mord mathrm">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></p></li></ol><ol type="1" id="15b9ad28-a8e1-8081-a56b-d87134cb99f1" class="numbered-list" start="2"><li>Pixel-to-Camera Conversion:<p id="15b9ad28-a8e1-8071-bdca-e798016240ad" class="">Using the intrinsic matrix <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span>:</p><figure id="15b9ad28-a8e1-80c6-a974-d39b788e2faa" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>K</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>f</mi><mi>x</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>o</mi><mi>x</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>f</mi><mi>y</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>o</mi><mi>y</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">K=\left[\begin{array}{ccc}f_x &amp; 0 &amp; o_x \\0 &amp; f_y &amp; o_y \\0 &amp; 0 &amp; 1\end{array}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="15b9ad28-a8e1-8016-b594-dddae8cefde4" class="">I mapped 2D pixel coordinates <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> back into 3D camera space with depth <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span><span>﻿</span></span>:</p><figure id="15c9ad28-a8e1-8015-ae72-d176124cd567" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mi>c</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mi>c</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>z</mi><mi>c</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mi>s</mi><mo>⋅</mo><msup><mi>K</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>u</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>v</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left[\begin{array}{l}x_c \\y_c \\z_c\end{array}\right]=s \cdot K^{-1} \cdot\left[\begin{array}{l}u \\v \\1\end{array}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">u</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure></li></ol><ol type="1" id="15b9ad28-a8e1-80e5-95a8-cdb690e53a7f" class="numbered-list" start="3"><li>Pixel-to-Ray Mapping:<p id="15b9ad28-a8e1-8071-bb99-f6614255ae8f" class="">For each pixel <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>, the ray origin <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">r</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{r}_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> was the camera position, obtained from the c2w matrix translation <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span>:         <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">r</mi><mi>o</mi></msub><mo>=</mo><mi mathvariant="bold">t</mi><mo>=</mo><mi mathvariant="normal">c</mi><mn>2</mn><mi mathvariant="normal">w</mi><mo stretchy="false">[</mo><mo>:</mo><mn>3</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{r}_o=\mathbf{t}=\mathrm{c} 2 \mathrm{w}[: 3,3]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6349em;"></span><span class="mord mathbf">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathrm">c</span><span class="mord">2</span><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mopen">[</span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span></p><p id="15b9ad28-a8e1-8062-adfb-cfdeb38650a4" class="">The ray direction <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">r</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{r}_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> was calculated by transforming a point along the ray (e.g., at <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span>) into the world space and normalizing:</p><figure id="15b9ad28-a8e1-8039-84b9-f16dc61a0f99" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">r</mi><mi>d</mi></msub><mo>=</mo><mfrac><mrow><msub><mi mathvariant="bold">x</mi><mi>w</mi></msub><mo>−</mo><msub><mi mathvariant="bold">r</mi><mi>o</mi></msub></mrow><msub><mrow><mo fence="true">∥</mo><msub><mi mathvariant="bold">x</mi><mi>w</mi></msub><mo>−</mo><msub><mi mathvariant="bold">r</mi><mi>o</mi></msub><mo fence="true">∥</mo></mrow><mn>2</mn></msub></mfrac><mo separator="true">,</mo><mspace width="1em"/><msub><mi mathvariant="bold">x</mi><mi>w</mi></msub><mo>=</mo><mi mathvariant="normal">c</mi><mn>2</mn><mi mathvariant="normal">w</mi><mo>⋅</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mi>c</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mi>c</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>z</mi><mi>c</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{r}_d=\frac{\mathbf{x}_w-\mathbf{r}_o}{\left\|\mathbf{x}_w-\mathbf{r}_o\right\|_2}, \quad \mathbf{x}_w=\mathrm{c} 2 \mathrm{w} \cdot\left[\begin{array}{c}x_c \\y_c \\z_c \\1\end{array}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.246em;vertical-align:-0.9857em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathrm">c</span><span class="mord">2</span><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:4.8em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='4.800em' viewBox='0 0 667 4800'><path d='M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1200 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='4.800em' viewBox='0 0 667 4800'><path d='M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1200 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure></li></ol><h3 id="15b9ad28-a8e1-80ce-bf39-fc59e45d2214" class="">Part 2.2: Sampling Rays from Images</h3><p id="15b9ad28-a8e1-809a-8c53-f24f0a39d110" class="">In this part, I worked on sampling rays and points in 3D space to prepare for training the NeRF. </p><p id="15b9ad28-a8e1-80c3-98e0-f4b5f18e9a37" class="">First sampling the rays. I started by selecting random pixels from the images. Using the camera intrinsics K and extrinsics (c2w matrix), I converted these pixels into rays. Each ray has an origin ro (the camera position) and a direction rd (a normalized vector pointing into the scene). To make sure the calculations were accurate, I added 0.5 to pixel coordinates to account for the offset to the pixel center. Once I had the rays, I sampled points along them in 3D space. For each ray, I picked 32–64 evenly spaced points between a near plane (2.0) and a far plane (6.0). To avoid overfitting, I added a small random offset to the positions of these points during training. By the end, I had a set of sampled 3D points for every ray, ready to use for the next part of the project. </p><h3 id="15b9ad28-a8e1-80df-a729-cb1cb4e7ae44" class="">Part 2.3: Putting the Dataloader Together</h3><p id="15b9ad28-a8e1-8080-908d-f3eeab85ff3c" class="">In this part, I created a dataloader to sample rays and points from the multi-view images. The dataloader randomly picks pixels from the images. These pixel coordinates were normalized (divided by the image width and height) to make them fit within the range [0, 1]. Using the camera intrinsics <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span> and extrinsics (c2w matrices), I converted the sampled pixels into rays. Each ray included the ray origin (the camera’s position, directly from the c2w matrix) and the ray direction (a normalized vector pointing into the scene, calculated from the pixel-to-ray process). Thus in total the dataloader returns the ray origin, ray direction and pixel colors.</p><p id="15b9ad28-a8e1-8028-bc89-c47116bfc69b" class="">To test my implementation, I visualized the sampled rays along with the cameras as seen below.</p><div id="15b9ad28-a8e1-8099-85f6-f63a381d3f8a" class="column-list"><div id="15b9ad28-a8e1-8066-8326-ca32f50be52a" style="width:43.75%" class="column"><figure id="15b9ad28-a8e1-8012-826a-d28d13edf64a" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/508ad9d2-031c-4f46-8de8-e060f640f5ac.png"><img style="width:317.1752837326608px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/508ad9d2-031c-4f46-8de8-e060f640f5ac.png"/></a><figcaption>100 randomly sampled rays</figcaption></figure><p id="15b9ad28-a8e1-8084-818a-e8a5c6c66109" class="">
</p></div><div id="15b9ad28-a8e1-802a-a4cf-e713f62624c1" style="width:56.25%" class="column"><figure id="15b9ad28-a8e1-8055-b3c9-d6f57b8a2d97" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/fc84c58a-2f53-434c-a6a4-3c38ba3d63f1.png"><img style="width:425.112582781457px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/fc84c58a-2f53-434c-a6a4-3c38ba3d63f1.png"/></a><figcaption>Rays samples from one camera </figcaption></figure><p id="15b9ad28-a8e1-80b4-bbc9-de48e1e1a72d" class="">
</p></div></div><h3 id="15b9ad28-a8e1-80ae-8358-d42dab7a96aa" class="">Part 2.4 Neural Radiance Field</h3><p id="15b9ad28-a8e1-8044-b451-f90f1d21b14b" class="">Now we create the model architecture to predict the density and color of points. This is similar to what we did in part 1 with the MLP, but this MLP has more inputs given the 3D world coordinates and a 3D view direction and more outputs RGB color and density. Because this task is more challenging the network is deeper and more complex and can be seen below:</p><figure id="15b9ad28-a8e1-80e7-942a-dbbc979e789a" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2022.png"><img style="width:4180px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2022.png"/></a></figure><h3 id="15b9ad28-a8e1-8079-81c2-cf9739381b33" class="">Part 2.5: Volume Rendering</h3><p id="15b9ad28-a8e1-803c-a3c6-e91ffbb5bd7f" class="">Now we can sample from our network to get the colors and density of points along the rays. I used the volume rendering equation to combine color <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span>﻿</span></span> and density <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span>  for points sampled along each ray. For every small step <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> along a ray, the color contribution is weighted by the probability of the ray terminating at that point:</p><figure id="15b9ad28-a8e1-8035-8d9c-fe724fad988e" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>C</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>T</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>σ</mi><mi>i</mi></msub><msub><mi>δ</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><msub><mi mathvariant="bold">c</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}      \hat{C}(\mathbf{r})=\sum_{i=1}^N T_i\left(1-\exp \left(-\sigma_i \delta_i\right)\right) \mathbf{c}_i\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.406em;vertical-align:-1.453em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.953em;"><span style="top:-3.953em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.453em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="15b9ad28-a8e1-8094-8a51-d05dd97acf15" class="">Where:</p><ul id="15b9ad28-a8e1-800f-9779-e749f545cf2c" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>σ</mi><mi>j</mi></msub><msub><mi>δ</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>:</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle T_i=\exp \left(-\sum_{j=1}^{i-1} \sigma_j \delta_j\right):</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2254em;vertical-align:-1.4138em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8117em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span></span><span>﻿</span></span> Probability that the ray hasn&#x27;t stopped before sample <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span>.</li></ul><ul id="15b9ad28-a8e1-8015-afd7-c09e6d7f7aa5" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\delta_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>: Step size between consecutive samples.</li></ul><ul id="15b9ad28-a8e1-8000-8360-de0ed146bf5d" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>: Density predicted by the NeRF at sample <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span></li></ul><p id="15b9ad28-a8e1-80be-b95a-cac7675f3539" class="">Here are the results using an Adam optimizer with a learning rate of 5e-4 with a batch size of 10k rays with a total of 500 iterations</p><div id="15b9ad28-a8e1-80dd-8d63-ecca96cddbcf" class="column-list"><div id="15b9ad28-a8e1-8082-aabb-d738e879931f" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-805a-9e51-ffea51215320" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/e4255d82-750a-49f4-9ee7-7a031e86aae4.png"><img style="width:309.9815837937385px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/e4255d82-750a-49f4-9ee7-7a031e86aae4.png"/></a></figure></div><div id="15b9ad28-a8e1-80e3-a071-fe2fe1065e71" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-80ca-ac76-f943426d032f" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/02fd1264-9ca9-4837-a6ab-dcb7b27d5e58.png"><img style="width:311.0614525139665px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/02fd1264-9ca9-4837-a6ab-dcb7b27d5e58.png"/></a></figure></div><div id="15b9ad28-a8e1-80f3-8335-c0719f0d644e" style="width:33.33333333333333%" class="column"><figure id="15b9ad28-a8e1-8025-8bdb-ee1a851dabb5" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/f79a97f8-d836-445c-9a5c-025153e09981.png"><img style="width:308.14814814814815px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/f79a97f8-d836-445c-9a5c-025153e09981.png"/></a></figure></div></div><div id="15b9ad28-a8e1-8007-bfb6-f587f0de0b9a" class="column-list"><div id="15b9ad28-a8e1-80d1-97c3-fa8265b1c60b" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-80e2-b1cd-d01441cd4588" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/15978cf6-3b1a-41cd-9831-8202e3cd6a2b.png"><img style="width:307.53246753246754px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/15978cf6-3b1a-41cd-9831-8202e3cd6a2b.png"/></a></figure></div><div id="15b9ad28-a8e1-80bf-9db8-eebcd3699928" style="width:33.33333333333333%" class="column"><figure id="15b9ad28-a8e1-8043-86cd-fa7e3fe524e3" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/3e55d072-2ded-493e-91db-57d015470a1e.png"><img style="width:307.55555555555554px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/3e55d072-2ded-493e-91db-57d015470a1e.png"/></a></figure></div><div id="15b9ad28-a8e1-80ef-bdfa-fe59ed283b8b" style="width:33.33333333333334%" class="column"><figure id="15b9ad28-a8e1-80fd-b131-cfa7a4c4cfa5" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/2358bd8e-aa36-4fe4-8b66-35627e739516.png"><img style="width:307.53246753246754px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/2358bd8e-aa36-4fe4-8b66-35627e739516.png"/></a></figure></div></div><div id="15b9ad28-a8e1-8088-aa02-dd697b59211d" class="column-list"><div id="15b9ad28-a8e1-808b-850d-e6f4ee7ad502" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-80d3-b1b9-d75d70e747b6" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/30e1ae22-12ec-4b06-a975-dc127c89ee88.png"><img style="width:305.75139146567716px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/30e1ae22-12ec-4b06-a975-dc127c89ee88.png"/></a></figure></div><div id="15b9ad28-a8e1-8046-bccf-f7388721509d" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-8084-a377-c549c10b2240" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/424573a1-8ac6-4e4f-8d9b-640ed4da99f7.png"><img style="width:306.3450834879406px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/424573a1-8ac6-4e4f-8d9b-640ed4da99f7.png"/></a></figure></div><div id="15b9ad28-a8e1-8019-954a-caa4ee5bf4c9" style="width:33.33333333333333%" class="column"><figure id="15b9ad28-a8e1-8017-b2db-efa7a5de5f9b" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/d65ff816-1876-47f7-917a-ccee03e6187f.png"><img style="width:307.53246753246754px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/d65ff816-1876-47f7-917a-ccee03e6187f.png"/></a></figure></div></div><figure id="15b9ad28-a8e1-80c9-ae46-e4758db98063" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2023.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2023.png"/></a></figure><p id="15b9ad28-a8e1-8008-b1ba-f56c725c7c9c" class="">And the resulting PSNR curve as well is displayed</p><p id="15b9ad28-a8e1-804a-a65a-df9eda413ddb" class="">But increasing the training time iterations we get a much clearer picture</p><div id="15b9ad28-a8e1-80a4-804e-c637869104d8" class="column-list"><div id="15b9ad28-a8e1-806b-b0b7-cfc2c4328673" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-8085-946a-f6c1cf090c62" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/988faf0f-01a5-4cf5-ac94-97963cdf4230.png"><img style="width:306.3450834879406px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/988faf0f-01a5-4cf5-ac94-97963cdf4230.png"/></a></figure></div><div id="15b9ad28-a8e1-809a-b71b-e25dc52d9d59" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-802e-a323-f2a17bb5c584" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/a93b94f4-fbfd-4d02-a463-1c2b0bda29ae.png"><img style="width:306.3450834879406px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/a93b94f4-fbfd-4d02-a463-1c2b0bda29ae.png"/></a></figure></div><div id="15b9ad28-a8e1-804c-8c21-edd6014d2f2b" style="width:33.33333333333333%" class="column"><figure id="15b9ad28-a8e1-80a5-9d1b-f99c3a98c0f0" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/dc06dbf5-104d-4b2f-94db-288e31bba254.png"><img style="width:307.53246753246754px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/dc06dbf5-104d-4b2f-94db-288e31bba254.png"/></a></figure></div></div><div id="15b9ad28-a8e1-80ea-8a5c-fd6e5858359f" class="column-list"><div id="15b9ad28-a8e1-80d4-801f-d8fa152ca182" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-80f4-aba3-f4e4312ade8a" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/04260650-da21-4353-af5a-e055fe437213.png"><img style="width:305.75139146567716px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/04260650-da21-4353-af5a-e055fe437213.png"/></a></figure></div><div id="15b9ad28-a8e1-808b-832a-ee85f05a4961" style="width:33.333333333333336%" class="column"><figure id="15b9ad28-a8e1-800e-98f8-c1b1a9634f0c" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/7f0eb6bf-6dd4-42e2-aa4e-664bcef0eb58.png"><img style="width:305.18518518518516px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/7f0eb6bf-6dd4-42e2-aa4e-664bcef0eb58.png"/></a></figure></div><div id="15b9ad28-a8e1-8099-b575-d759b34198a6" style="width:33.33333333333333%" class="column"><figure id="15b9ad28-a8e1-8047-8516-fe191db51142" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/6ddc4486-da34-4a7e-8e35-e57fa01e3f25.png"><img style="width:306.98706099815155px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/6ddc4486-da34-4a7e-8e35-e57fa01e3f25.png"/></a></figure></div></div><figure id="15c9ad28-a8e1-80b8-ac36-e0e4e28be2af" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2024.png"><img style="width:708px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/image%2024.png"/></a></figure><p id="15b9ad28-a8e1-801c-8911-e311ccab4313" class="">Putting it all together, here are the resulting GIFs the left is the ~6 minute training while the right is the ~2 hours training (Colab would keep crashing beyond this)</p><div id="15c9ad28-a8e1-80f9-9705-e03c2b915808" class="column-list"><div id="15c9ad28-a8e1-80ee-9a04-d94715372740" style="width:50%" class="column"><figure id="15b9ad28-a8e1-8000-8de0-faf93e604683" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_lego_gif-ezgif.com-video-to-gif-converter.gif"><img style="width:208px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_lego_gif-ezgif.com-video-to-gif-converter.gif"/></a></figure></div><div id="15c9ad28-a8e1-80af-9ebf-e0dc5a0439e0" style="width:50%" class="column"><figure id="15c9ad28-a8e1-8049-aa59-ec708d178fe3" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_large_lego1-ezgif.com-video-to-gif-converter.gif"><img style="width:208px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_large_lego1-ezgif.com-video-to-gif-converter.gif"/></a></figure></div></div><p id="15b9ad28-a8e1-8090-9832-d4c0a7d94dd6" class="">
</p><h3 id="15b9ad28-a8e1-80da-8a1e-db0390097c94" class="">Bell’s and Whistles:</h3><p id="15b9ad28-a8e1-80d2-9d51-c62376e2e44d" class="">For the required bells and whistles I injected background color into the volume rendering equation these are the results again left is the ~6 minute training while the right is the ~2 hours training</p><div id="15c9ad28-a8e1-8020-a11f-d1f546314e48" class="column-list"><div id="15c9ad28-a8e1-8099-ba6c-c61a25b4b9ab" style="width:50%" class="column"><figure id="15b9ad28-a8e1-804f-b8df-c5df64ae9b66" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_lego_blue_bg-ezgif.com-video-to-gif-converter.gif"><img style="width:208px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_lego_blue_bg-ezgif.com-video-to-gif-converter.gif"/></a></figure></div><div id="15c9ad28-a8e1-8092-a6d4-e69e8c2ab7b9" style="width:50%" class="column"><figure id="15c9ad28-a8e1-8022-a3cc-ff1dbbe11b9d" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_large_lego_blue_bg_v0-ezgif.com-video-to-gif-converter.gif"><img style="width:208px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_large_lego_blue_bg_v0-ezgif.com-video-to-gif-converter.gif"/></a></figure></div></div><p id="15c9ad28-a8e1-80ce-8362-f930a9f7f023" class="">Interestingly the background with more training although has a clearer render of the Lego has a worse background. I think maybe this is due to that when there are fewer iterations, the network has a more &quot;blurry&quot; or general understanding, and thus densities are more smoothly distributed, which results in smoother background transitions. So to get around this I decided to do a somewhat balanced approach of the two and use less training (around 20 minutes) which results in the following</p><figure id="15c9ad28-a8e1-804c-a82b-f3e7166e1490" class="image"><a href="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_med_lego_blue_bg.gif"><img style="width:200px" src="CS180%20-%20Final%20Project%2015a9ad28a8e1803ab200d5845c6c1619/nerf_med_lego_blue_bg.gif"/></a></figure><p id="15c9ad28-a8e1-80db-a3a6-d1a1116a146b" class="">(different speed of rotation due to different conversion to GIF method)</p><p id="15c9ad28-a8e1-8049-aeb3-fceb09319769" class="">I also tried doing the 30+ PSNR attempt, but my model was too deep and I ended up getting only  black reconstructions due to a vanishing gradient (I think).</p><p id="15c9ad28-a8e1-80d1-9a62-e6eb976f9af2" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>